{% extends 'index.html' %}
{% block body %}
    <main class="title">
        <div class="title-block">
            <div class="row">
                <div class="col-12 col-lg-7">
                    <div class="row">
                        <div class="col-7 title-name">
                            <h3>{{ title.title }}</h3>
                            <hr/>
                        </div>
                        <div class="col-5 title-ratings">
                            <span><img src="{{ url_for('static', filename='favicon/favicon.png') }}" alt="TGMB."/>{{ title.users_rating }}</span>
                            <span><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/cc/IMDb_Logo_Square.svg/1200px-IMDb_Logo_Square.svg.png" alt="imdb"/>{{ title.imdb_rating }}</span>
                            <span><img src="https://upload.wikimedia.org/wikipedia/commons/f/f2/Metacritic_M.png" alt="metascore"/>{{ title.metascore }}</span>
                        </div>
                    </div>
                    <div class="small-info">
                        <span>{{ title.rated }}
                            Rated |
                        </span>
                        <span>{{ title.runtime }}
                            |
                        </span>
                        <span>{{ title.genre }}</span>
                    </div>
                    <div class="title-poster">
                        <div class="row">
                            <img src="{{ title.poster }}" alt=""/>
                            <iframe class="title-trailer" src="https://www.youtube.com/embed/{{ title.youtube_id }}" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-lg-5 title-info">
                    <h5>Movie Info</h5>
                    <hr/>
                    <p>
                        <strong>Directors:
                        </strong>
                        {{ title.director }}
                    </p>
                    <p>
                        <strong>Actors:
                        </strong>
                        {{ title.actors }}
                    </p>
                    <p>
                        <strong>Plot:
                        </strong>
                        {{ title.plot }}
                    </p>
                    <p>
                        <strong>Studio:
                        </strong>
                        {{ title.production }}
                    </p>
                    <p>
                        <strong>Release:
                        </strong>
                        {{ title.released }}
                    </p>
                </div>
            </div>
        </div>
        <div class="reviews-block mt-2 mt-lg-3">
            <div class="row">
                <div class="col-12 col-lg-7">
                    {% if username %}
                        {% if not user_review == [] %}
                            <h5 class="mt-2">Thank you!</h5>
                            <hr/>
                            <p>If you want to edit your review go to your profile.</p>
                            <a href="/profile" class="btn btn-secondary mb-2" role="button">My Profile</a>
                        {% else %}
                            {% include 'includes/_reviewform.html' %}
                        {% endif %}
                    {% else %}
                        <h5 class="mt-2">Leave a review</h5>
                        <hr/>
                        <p>To leave a review you must be logged in first.</p>
                        <a href="/login" class="btn btn-secondary mb-2" role="button">Log In</a>
                    {% endif %}
                </div>
                {% if not reviews %}
                    <div class="reviews col-12 col-lg-5">
                        <h5>Latest Reviews</h5>
                        <hr/>
                        <p>There are no reviews to show yet.</p>
                    </div>
                {% else %}
                    <div class="reviews col-12 col-lg-5">
                        <h5>Latest Reviews</h5>
                        <hr/>
                        {% set count = namespace(value=0) %}
                        {% for review in reviews %}
                            {% if count.value < 5 %}
                                {% set count.value = count.value + 1 %}
                                <ul class="list-group">
                                    <li>
                                        <a href="{{ url_for('review', review_choice=review.review_id) }}">
                                            <p>{{ review.title }}
                                                -</p>
                                            <p>{{ review.user }}</p>
                                            <p>
                                                <img src="{{ url_for('static', filename='favicon/favicon.png') }}" alt="Film Dazzle."/>{{ review.rating }}<small>/5</small>
                                            </p>
                                        </a>
                                    </li>
                                </ul>
                            {% endif %}
                        {% endfor %}
                    </div>
                {% endif %}
            </div>
        </div>
    </main>
{% endblock %}
